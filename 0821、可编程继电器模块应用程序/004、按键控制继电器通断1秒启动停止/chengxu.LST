C51 COMPILER V8.05a   CHENGXU                                                              01/02/2012 14:56:31 PAGE 1   


C51 COMPILER V8.05a, COMPILATION OF MODULE CHENGXU
OBJECT MODULE PLACED IN chengxu.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE chengxu.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          /********************************************************************
   2                                      汇诚科技
   3          
   4          实现功能:秒延时2秒程序
   5          使用芯片：STC15F104E
   6          晶振：12MHZ
   7          波特率：9600
   8          编译环境：Keil
   9          作者：zhangxinchunleo
  10          网站：www.ourhc.cn
  11          淘宝店：汇诚科技 http://shop36330473.taobao.com
  12          【声明】此程序仅用于学习与参考，引用请注明版权和作者信息！     
  13          
  14          *********************************************************************/
  15          /********************************************************************/
  16          
  17          #include<reg52.h>              //库文件
  18          #define uchar unsigned char//宏定义无符号字符型
  19          #define uint unsigned int  //宏定义无符号整型
  20          /********************************************************************
  21                                      初始定义
  22          *********************************************************************/
  23          uchar sec; //定义计数值，每过1/10 秒，sec 加一
  24          uchar keycnt=0;//按下次数值
  25          uint tcnt; //键值判断
  26          /********************************************************************
  27                                      I/O定义
  28          *********************************************************************/
  29          sbit P33=P3^3;   //定义单片机P3口的第3位 （即P3.3）
  30          sbit P3_5=P3^5;
  31          /********************************************************************
  32                                      延时函数
  33          *********************************************************************/
  34          void delay(uchar t)
  35          {
  36   1        uchar i,j;
  37   1         for(i=0;i<t;i++)
  38   1         {
  39   2               for(j=13;j>0;j--);
  40   2               { ;
  41   3               }
  42   2         }
  43   1      }
  44          
  45          /********************************************************************
  46                                      按键扫描函数
  47          *********************************************************************/
  48          void KEY() //按键扫描程序
  49          {
  50   1      uchar i,j;
  51   1      if(P3_5==0)
  52   1              {
  53   2              delay(20);
  54   2              if(P3_5==0)
  55   2                      {
C51 COMPILER V8.05a   CHENGXU                                                              01/02/2012 14:56:31 PAGE 2   

  56   3                              keycnt++;
  57   3      /********************************************************************
  58   3                                  按下次数判断函数
  59   3      *********************************************************************/
  60   3      switch(keycnt) //按下次数判断
  61   3              {
  62   4              case 1: //第一次按下
  63   4              TH0=0x06; //对TH0 TL0 赋值
  64   4              TL0=0x06;
  65   4              TR0=1; //开始定时
  66   4              break;
  67   4              case 2: //第二次按下
  68   4              TR0=0; //定时结束
  69   4              keycnt=0; //重新开始判断键值
  70   4              break;
  71   4              }
  72   3              while(P3_5==0);
  73   3                      } 
  74   2              }
  75   1      }
*** WARNING C280 IN LINE 50 OF CHENGXU.C: 'i': unreferenced local variable
*** WARNING C280 IN LINE 50 OF CHENGXU.C: 'j': unreferenced local variable
  76          /********************************************************************
  77                                      定时中断服务函数
  78          *********************************************************************/
  79          void t0(void) interrupt 1 using 0 //定时中断服务函数
  80          {
  81   1              tcnt++; //每过250ust tcnt 加一
  82   1              if(tcnt==400) //计满400 次（1/10 秒）时
  83   1              {
  84   2                      tcnt=0; //重新再计
  85   2                      sec++;
  86   2                      if(sec==10) //定时10 秒，在从零开始计时
  87   2                      {
  88   3                              sec=0;
  89   3                              P33=!P33;  //取反 P3.3
  90   3                      }
  91   2              }
  92   1      }
  93          
  94          /********************************************************************
  95                                      主函数
  96          *********************************************************************/
  97          void main()
  98          {
  99   1              TMOD=0x02; //定时器工作在方式2
 100   1              ET0=1;
 101   1              EA=1;
 102   1              sec=0;
 103   1              TR0=0;
 104   1              while(1)
 105   1              {
 106   2               KEY();
 107   2              }
 108   1      }               
 109          
 110                  
 111          /********************************************************************
 112                                        结束
 113          *********************************************************************/


C51 COMPILER V8.05a   CHENGXU                                                              01/02/2012 14:56:31 PAGE 3   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    116    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  2 WARNING(S),  0 ERROR(S)
