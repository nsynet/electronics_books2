 var __sid_51much = 'UA-1-7240';
 _51much_stat(); 

function SetCookie(cookieName, cookieVal) {
	var exp=new Date();
	exp.setTime(exp.getTime()+(365*24*60*60*1000));

	document.cookie=cookieName+'='+cookieVal+'; expires='+exp.toGMTString();
	}

function GetCookie(cookieName) {
	if(document.cookie) {
		var index=document.cookie.indexOf(cookieName);
		if (index != -1) {
			var countbegin=(document.cookie.indexOf(cookieName+'=', index) + 1);
			var countend=document.cookie.indexOf(';', index);
			if (countend == -1) {
				countend=document.cookie.length;
				}
			return document.cookie.substring(countbegin + cookieName.length, countend);
			}
		}
	return null;
	}
	
//stat
function today_days(tdate){
	var tdate;
	var adate = tdate.split("-"); 
	d1 = new Date(adate[0],adate[1]-1,adate[2],0,0,0,0);
	d2 = new Date();
	s = Math.ceil(((d2.getTime() - d1.getTime())/(24*60*60*1000)))-1;
	return (s);
}

function _51much_stat(){

var fromr=top.document.referrer;
fromr=(fromr=="")? (parent.document.referrer =="" ? document.referrer : parent.document.referrer):fromr;
var c_page=top.document.location.href;
c_page = c_page.substr(7);
c_page = c_page.replace("@^","");
c_page = c_page.replace("&~","");
c_page = c_page.replace("^@","");
// c_page = c_page =="" ? document.location.href : c_page;
var c_title=top.document.title;
c_title = c_title =="" ? document.title : c_title;

var s_51much = __sid_51much.split('-');
var sid_51much = s_51much[2];

//cookie enabled
var ce=(navigator.cookieEnabled) ? '1' : '0';
if ((typeof (navigator.cookieEnabled) =="undefined") && (ce == '0')) {   
	document.cookie="much_testcookie"
	ce=(document.cookie.indexOf("much_testcookie")!=-1)? '1' : '0';
}

var sUserAgent = window.navigator.userAgent;
var today1 = new Date() ;
var t_year = today1.getYear();
var t_month = today1.getMonth() + 1;
var t_day = today1.getDate();
var t_date = t_year + '-' + t_month + '-' + t_day;
var Ntime = Math.round(today1.getTime()/1000);
var q_first_v_time = '',q_last_days = '',q_vtimes = '',q_a_ol='',q_t_ol='',q_vdepth='',q_wpages='',days=0,wpages='',c_host='122.225.100.205/',c_prog='count.php';
var o_time = 1800,vtype;

if(ce == 1) {
var cookie_51much = GetCookie("cookie_51much_"+sid_51much);

if(cookie_51much ==  null)
{ 
  	var c_value = t_date + "|1|"+ Ntime+ "|"+ Ntime + "|5|5|1|@^" + c_page + "&~" + Ntime + "^@";
  	SetCookie("cookie_51much_"+sid_51much,c_value);
  	vtype='0';
}else {
	      var c_51much0 = cookie_51much.split("@^");
	      var c_51much = c_51much0[0];
				c_51much = cookie_51much.split("|"); 
				if(c_51much[0] != t_date)
				{
  			++ c_51much[1];
  			c_51much[4] = Math.round(c_51much[4]) + 5;
  			c_51much[5] =  5;
  			c_51much[6] =  1;
  			
  			
   			c_value = t_date + "|" + c_51much[1] + "|" + c_51much[2] + "|" + Ntime+ "|" +  c_51much[4] + "|" +  c_51much[5] + "|" +  c_51much[6] + "|@^" + c_page + "&~" + Ntime + "^@";
  			SetCookie("cookie_51much_"+sid_51much,c_value);

 	  		tdays = today_days(c_51much[0]);
  			q_last_days = '&lastvdays=' + tdays;
  			q_first_v_time = '&first_time=' + c_51much[2] + '';
  			
  			vtype='1';
   			}else if((Math.round(c_51much[3]) + Math.round(o_time)) > Ntime){
   				      c_51much[4] = Math.round(c_51much[4]) + Math.round(Ntime) - Math.round(c_51much[3]);
   				      c_51much[5] = Math.round(c_51much[5]) + Math.round(Ntime) - Math.round(c_51much[3]);
   				      
   				      var c_51much1 = c_51much0[1].split("^@");
   				      var c_51much2 = c_51much1[0].split("&~");
   				      //if(c_51much1.length >2)  var c_51much3 = c_51much1[1].split("&~"); && c_page != c_51much3[0]
   				      
   						  if(c_page != c_51much2[0] ) {
   						  	 ++ c_51much[6];   				      
   						  	wpages =  c_page + "&~" + Ntime + "^@" + c_51much0[1]; //+ c_title + "&~"
   				       }else {
   				       	wpages = c_51much0[1];
   				       }
   				      
   							c_value = t_date + "|" + c_51much[1] + "|" + c_51much[2] + "|" + Ntime+ "|" +  c_51much[4] + "|" +  c_51much[5] + "|" +  c_51much[6] + "|@^" + wpages + "";
  							SetCookie("cookie_51much_"+sid_51much,c_value);
  							q_wpages = "&wpages="+escape(wpages);
  							vtype='2';
   						}else {
   							++ c_51much[1];
   							c_51much[4] = Math.round(c_51much[4]) + 30;
   							c_51much[5] = Math.round(c_51much[5]) + 30;
   						  c_51much[6] =  1;
   						  
   							c_value = t_date + "|" + c_51much[1] + "|" + c_51much[2] + "|" + Ntime+ "|" +  c_51much[4] + "|" +  c_51much[5] + "|" +  c_51much[6] + "|@^" + c_page + "&~" + Ntime + "^@";
  							SetCookie("cookie_51much_"+sid_51much,c_value);
  							vtype='3';
   						}
   			 	q_vtimes = '&vtimes=' + c_51much[1];
   	 			q_a_ol = '&a_ol=' + c_51much[4];
   	  		q_t_ol = '&t_ol=' + c_51much[5];
   	  		q_vdepth = '&vdepth=' + c_51much[6];
		}

}

 if (navigator.language) { var c_lang=navigator.language.toLowerCase(); }
 else if (navigator.browserLanguage) { var c_lang=navigator.browserLanguage.toLowerCase(); }
 
var je=navigator.javaEnabled()?1:0;
var sr,sc;
 if (self.screen) {
  sr=screen.width+"x"+screen.height;
  sc=screen.colorDepth;
 } else if (self.java) {
  var j=java.awt.Toolkit.getDefaultToolkit();
  var s=j.getScreenSize();
  sr=s.width+"x"+s.height;
 }
 
var query = '?sid=' + sid_51much + '&vtype=' + vtype + '&c_lang=' + c_lang +  '&c_page=' + escape(c_page) + '&fromr=' + escape(fromr) + '&sr=' + sr +'&sc=' + sc  +'&ce=' + ce  +'&uagent=' + escape(sUserAgent) + '&je=' + je + q_first_v_time + q_wpages + q_last_days + q_a_ol + q_t_ol + q_vtimes + q_vdepth ;

var style = 'icon';

var s1 =( style == 'icon') ? '<img src=http://www.51much.com/stat_images/logo.gif border=0>' : '流量统计';

document.write('<script src="http://'+ c_host + c_prog + query + '" type="text/javascript"></script>');

if(s_51much[0] == 'UA')  document.write('<a href=http://www.51much.com/report.jsp?sid='+ sid_51much +' target=_blank title="51Much免费流量统计，专业、安全、稳定的流量统计">'+ s1 +'</a>');

}
